<h1>Homes#index</h1>
<p>Find me in app/views/homes/index.html.erb</p>

<%= render_markdown(Blog.last&.content) %>

<%= form_for Blog.new do |form| %>
  <%= form.text_area :content, style: 'width: 100%; height: 30vh; font-size: 16px;', id: 'textbox' %>
  <div class='actions'>
    <%= form.submit 'Create' %>
  </div>
<% end %>

<script type="text/javascript">
  $(document).on("turbolinks:load", function() {
    $("#textbox").on('keydown', function(e) {
      var keyCode = e.keyCode || e.which;
      if(event.shiftKey && event.keyCode == 9) {
        e.preventDefault();
        var start = this.selectionStart;
        var end = this.selectionEnd;
        var valueBeforeCursor = $(this).val().substring(0, start);
        var removeLastTab = valueBeforeCursor.replace(/[\t]$/, '');
        if (removeLastTab.length < valueBeforeCursor.length) {
          $(this).val(removeLastTab + $(this).val().substring(end));
          this.selectionStart = this.selectionEnd = start - 1;
        } else {
          removeLastTab = valueBeforeCursor.replace(/[ ]+$/, '');
          if (removeLastTab.length < valueBeforeCursor.length) {
            $(this).val(removeLastTab + $(this).val().substring(end));
            this.selectionStart = this.selectionEnd = start - valueBeforeCursor.length + removeLastTab.length;
          }
        }
      } else if (keyCode == 9) {
        e.preventDefault();
        var start = this.selectionStart;
        var end = this.selectionEnd;

        // set textarea value to: text before caret + tab + text after caret
        $(this).val($(this).val().substring(0, start)
                    + "\t"
                    + $(this).val().substring(end));

        // put caret at right position again
        this.selectionStart = this.selectionEnd = start + 1;
      }
    });
  });
</script>